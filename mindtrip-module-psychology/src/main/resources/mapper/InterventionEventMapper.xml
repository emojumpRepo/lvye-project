<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lvye.mindtrip.module.psychology.dal.mysql.interventionplan.InterventionEventMapper">

    <!-- 分页查询正在进行的干预计划列表 -->
    <select id="selectOngoingPage"
            resultType="com.lvye.mindtrip.module.psychology.controller.admin.interventionplan.vo.InterventionPlanOngoingRespVO">
        SELECT a.id,
               a.intervention_id AS interventionId,
               a.title,
               a.student_profile_id AS studentProfileId,
               b.name AS studentName,
               b.student_no AS studentNo,
               c.name AS className,
               a.status,
               d.nickname AS creatorName,
               a.create_time AS createTime,
               a.update_time AS updateTime
        FROM lvye_intervention_event a
        LEFT JOIN lvye_student_profile b ON a.student_profile_id = b.id
        LEFT JOIN system_dept c ON b.class_dept_id = c.id
        LEFT JOIN system_users d ON a.creator = d.id
        <where>
            a.deleted = 0
            AND a.status = 1
        </where>
        ORDER BY a.create_time DESC
    </select>

</mapper>
