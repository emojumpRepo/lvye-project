# å¿ƒä¹‹æ—…é¡¹ç›®è„šæœ¬ç›®å½•

## ğŸ“ ç›®å½•ç»“æ„

```
script/
â”œâ”€â”€ release.mjs             # ä¸»å‘å¸ƒè„šæœ¬ï¼ˆç‰ˆæœ¬ç®¡ç†ï¼‰
â”œâ”€â”€ release-with-deploy.mjs # å®Œæ•´å‘å¸ƒè„šæœ¬ï¼ˆåŒ…å«æ„å»ºå’Œéƒ¨ç½²ï¼‰
â”œâ”€â”€ test-dify.mjs           # Dify API æµ‹è¯•å·¥å…·
â”œâ”€â”€ config/
â”‚   â””â”€â”€ deploy.config.js   # éƒ¨ç½²é…ç½®æ–‡ä»¶
â”œâ”€â”€ windows/
â”‚   â”œâ”€â”€ deploy-backend.mjs  # åç«¯éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ deploy-frontend.mjs # å‰ç«¯éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ docker/                 # Docker ç›¸å…³é…ç½®
â”œâ”€â”€ jenkins/                # CI/CD é…ç½®
â””â”€â”€ shell/                  # Shell è„šæœ¬
```

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### ç‰ˆæœ¬å‘å¸ƒï¼ˆæ¨èï¼‰

```bash
# ä½¿ç”¨ç‹¬ç«‹ç‰ˆæœ¬ç®¡ç†å‘å¸ƒ
npm run release

# äº¤äº’å¼é€‰æ‹©ï¼š
# - é€‰æ‹©é¡¹ç›®ï¼ˆåç«¯/å‰ç«¯/å…¨æ ˆï¼‰
# - é€‰æ‹©ç‰ˆæœ¬ç±»å‹ï¼ˆpatch/minor/majorï¼‰
# - ç¡®è®¤å‘å¸ƒ
```

### å®Œæ•´å‘å¸ƒæµç¨‹ï¼ˆåŒ…å«éƒ¨ç½²ï¼‰

```bash
# åŒ…å«æ„å»ºã€éƒ¨ç½²ã€é€šçŸ¥çš„å®Œæ•´æµç¨‹
npm run release:deploy
```

### å…¶ä»–å‘½ä»¤

```bash
# æ„å»ºå‘½ä»¤
npm run build:backend       # æ„å»ºåç«¯
npm run build:frontend      # æ„å»ºå‰ç«¯
npm run build:all          # æ„å»ºå…¨éƒ¨

# éƒ¨ç½²å‘½ä»¤
npm run deploy:backend      # éƒ¨ç½²åç«¯
npm run deploy:frontend     # éƒ¨ç½²å‰ç«¯
npm run deploy:all         # éƒ¨ç½²å…¨éƒ¨

# æµ‹è¯•å‘½ä»¤
npm run test:dify         # æµ‹è¯• Dify API
```

## ğŸ“ è„šæœ¬è¯´æ˜

### release.mjs
- **åŠŸèƒ½**ï¼šä¸»å‘å¸ƒè„šæœ¬ï¼Œç®¡ç†ç‰ˆæœ¬å·
- **ç‰¹ç‚¹**ï¼š
  - å‰åç«¯ç‹¬ç«‹ç‰ˆæœ¬å·ï¼ˆä» v0.0.1 å¼€å§‹ï¼‰
  - æ™ºèƒ½ Git commits è·å–
  - è‡ªåŠ¨ç”Ÿæˆ AI å‘å¸ƒæ—¥å¿—
  - é£ä¹¦é€šçŸ¥é›†æˆ
  - Master åˆ†æ”¯ä¿æŠ¤
  - å‰ç«¯æ ‡ç­¾åœ¨ç‹¬ç«‹ä»“åº“åˆ›å»º

### release-with-deploy.mjs
- **åŠŸèƒ½**ï¼šå®Œæ•´çš„å‘å¸ƒæµç¨‹è„šæœ¬
- **ç‰¹ç‚¹**ï¼š
  - åŒ…å«æ„å»ºå’Œéƒ¨ç½²æ­¥éª¤
  - è‡ªåŠ¨å‹ç¼©å’Œä¸Šä¼ 
  - æœåŠ¡å™¨è‡ªåŠ¨é‡å¯
  - å®Œæ•´çš„é”™è¯¯å¤„ç†

### deploy-backend.mjs / deploy-frontend.mjs
- **åŠŸèƒ½**ï¼šç‹¬ç«‹çš„éƒ¨ç½²è„šæœ¬
- **ç‰¹ç‚¹**ï¼š
  - SSH è¿œç¨‹éƒ¨ç½²
  - è‡ªåŠ¨å¤‡ä»½
  - æœåŠ¡ç®¡ç†
  - è¿›åº¦æ˜¾ç¤º

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡
æ‰€æœ‰æ•æ„Ÿé…ç½®éƒ½åœ¨ `config/deploy.config.js` ä¸­ç®¡ç†ï¼š

```javascript
{
  dify: {
    apiKey: 'app-xxx',      // Dify API Key
    apiUrl: 'http://xxx'    // Dify API åœ°å€
  },
  feishu: {
    webhook: 'https://xxx'  // é£ä¹¦ Webhook
  },
  server: {
    host: 'xxx',           // æœåŠ¡å™¨åœ°å€
    username: 'xxx',       // SSH ç”¨æˆ·å
    password: 'xxx'        // SSH å¯†ç 
  }
}
```

### ç‰ˆæœ¬æ–‡ä»¶
- **åç«¯**ï¼š`/version.properties`
- **å‰ç«¯**ï¼š`/mindtrip-ui/lvye-project-frontend/version.json`

## ğŸ·ï¸ Git æ ‡ç­¾è§„èŒƒ

- **åç«¯æ ‡ç­¾**ï¼š`mindtrip-backend-v{version}`ï¼ˆä¸»ä»“åº“ï¼‰
- **å‰ç«¯æ ‡ç­¾**ï¼š`mindtrip-frontend-v{version}`ï¼ˆå‰ç«¯ç‹¬ç«‹ä»“åº“ï¼‰
- **å…¨æ ˆæ ‡ç­¾**ï¼š`mindtrip-v{version}`ï¼ˆä¸»ä»“åº“ï¼‰

## ğŸ” å®‰å…¨è¯´æ˜

- æ‰€æœ‰æ•æ„Ÿä¿¡æ¯éƒ½åœ¨é…ç½®æ–‡ä»¶ä¸­ç®¡ç†
- é…ç½®æ–‡ä»¶ä¸åº”æäº¤åˆ° Git
- ä½¿ç”¨ç¯å¢ƒå˜é‡è¦†ç›–é»˜è®¤é…ç½®
- SSH è¿æ¥ä½¿ç”¨åŠ å¯†ä¼ è¾“

## ğŸ“š æ›´å¤šä¿¡æ¯

- [éƒ¨ç½²æ–‡æ¡£](./windows/README.md)
- [Docker ä½¿ç”¨](./docker/Docker-HOWTO.md)
- [é¡¹ç›®æ€»ç»“](./REFACTOR_SUMMARY.md)