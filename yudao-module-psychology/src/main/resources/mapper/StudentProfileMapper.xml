<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.iocoder.yudao.module.psychology.dal.mysql.profile.StudentProfileMapper">

    <select id="selectPageList"
            resultType="cn.iocoder.yudao.module.psychology.controller.admin.profile.vo.StudentProfileVO" >
        SELECT a.*,b.sex,b.mobile,c.name AS gradeName, d.name AS className FROM lvye_student_profile a
        LEFT JOIN system_users b ON a.user_id = b.id
        LEFT JOIN system_dept c ON a.grade_dept_id = c.id
        LEFT JOIN system_dept d ON a.class_dept_id = d.id
        <where>
            1 = 1
            <if test="pageReqVO.studentNo != null and pageReqVO.studentNo !=''">
                AND a.student_no = #{pageReqVO.studentNo}
            </if>
            <if test="pageReqVO.name != null and pageReqVO.name !=''">
                AND a.name = #{pageReqVO.name}
            </if>
            <if test="pageReqVO.sex != null">
                AND a.sex = #{pageReqVO.sex}
            </if>
            <if test="pageReqVO.gradeDeptId != null">
                AND a.grade_dept_id = #{pageReqVO.gradeDeptId}
            </if>
            <if test="pageReqVO.classDeptId != null">
                AND a.class_dept_id = #{pageReqVO.classDeptId}
            </if>
            <if test="pageReqVO.graduationStatus != null">
                AND a.graduation_status = #{pageReqVO.graduationStatus}
            </if>
            <if test="pageReqVO.psychologicalStatus != null">
                AND a.psychological_status = #{pageReqVO.psychologicalStatus}
            </if>
            <if test="pageReqVO.riskLevel != null">
                AND a.risk_level = #{pageReqVO.riskLevel}
            </if>
            ORDER BY id DESC
        </where>
    </select>

</mapper>